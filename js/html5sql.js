var html5sql=function(){var e=false,t=function(){},n=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},r=function(e){return Object.prototype.toString.call(e)==="[object Array]"},i=function(e){return e===void 0},s=new RegExp("^select\\s","i"),o=function(e){return s.test(e)},u=function(e,t,n,r){var i=0,s=null,u=function(){e.executeSql(t[i].sql,t[i].data,a,f)},a=function(e,r){var a,f,l=[];if(html5sql.logInfo){console.log("Success processing: "+t[i].sql)}if(html5sql.putSelectResultsInArray&&o(t[i].sql)){for(a=0,f=r.rows.length;a<f;a++){l[a]=r.rows.item(a)}}else{l=null}s=t[i].success(e,r,l);i++;if(s&&$.isArray(s)){t[i].data=s;s=null}else{s=null}if(t.length>i){u()}else{n(e,r,l)}},f=function(e,n){if(html5sql.logErrors){console.error("Error: "+n.message+" while processing statment "+(i+1)+": "+t[i].sql)}r(n,t[i].sql)};u()},a=function(e){var s;if(typeof e==="string"){n(e);e=e.split(";");for(s=1;s<e.length;s++){while(e[s].split(/["]/gm).length%2===0||e[s].split(/[']/gm).length%2===0||e[s].split(/[`]/gm).length%2===0){e.splice(s,2,e[s]+";"+e[s+1])}e[s]=n(e[s])+";";if(e[s]===";"){e.splice(s,1)}}}if(r(e)===false){e=[e]}for(s=0;s<e.length;s++){if(typeof e[s]==="string"){e[s]={sql:e[s],data:[],success:t}}else{if(i(e[s].data)){e[s].data=[]}if(i(e[s].success)){e[s].success=t}if(typeof e[s]!=="object"||typeof e[s].sql!=="string"||typeof e[s].success!=="function"||!$.isArray(e[s].data)){throw new Error("Malformed sql object: "+e[s])}}}return e},f=function(e){var t=0;do{if(!o(e[t].sql)){return false}t++}while(t<e.length);return true};return{database:null,logInfo:false,logErrors:false,defaultFailureCallback:t,putSelectResultsInArray:true,openDatabase:function(t,n,r,i){html5sql.database=openDatabase(t,"",n,r);e=typeof html5sql.database.readTransaction==="function";if(i){i()}},process:function(n,r,s){if(html5sql.database){var o=a(n);if(i(r)){r=t}if(i(s)){s=html5sql.defaultFailureCallback}if(f(o)&&e){html5sql.database.readTransaction(function(e){u(e,o,r,s)})}else{html5sql.database.transaction(function(e){u(e,o,r,s)})}}else{if(html5sql.logErrors){console.error("Error: Database needs to be opened before sql can be processed.")}return false}},changeVersion:function(e,n,r,s,o){if(html5sql.database){if(html5sql.database.version===e){var f=a(r);if(i(s)){s=t}if(i(o)){o=html5sql.defaultFailureCallback}html5sql.database.changeVersion(e,n,function(e){u(e,f,s,o)})}}else{if(html5sql.logErrors){console.log("Error: Database needs to be opened before sql can be processed.")}return false}}}}()